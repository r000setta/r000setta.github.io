---
layout:     post   				        #使用的布局（不需要改）
title:      PBRT note part 3	        #标题 
subtitle:   "Shapes"                    #副标题
date:       2019-12-19 				    #时间
author:     Jqy					        #作者
header-img: img/wallhaven-wywm6q.jpg	#这篇文章标题背景图片
catalog: true 						    #是否归档
tags:								    #标签
    - PBR
    - CG
    - PBRT
---

## Basic Shape Interface
All shapes are defined in coordinate space,in order to place them to world space,a transformation must be provided.
Shapes take parameter *reverseOrientation* to indicates their surface normal direction,and store *SwapHandedness* for their object-to-world transformation.

### Bounding
As the render process is often expensive,it's useful to have a 3D bounding volume that encloses the object,which can avoid process things the volumes didn't evolved.

Here use axis-aligned bounding boxes,which require six floating-point values to store,and the render provides two methods:
* ObjectBound():returns a bounding box in shape's object space.
* WorldBound():returns a bounding box in world space.
> Note:The default implementation of the WorldBound() is just to transform the object space bounding box to world space,but it's sometimes sloppy,and it could be better if first transform then fit the bounding box.

### Ray-Bounds Intersections

$$
0=a(o_x+td_x)+b(o_y+td_y)+c(o_z+td_z)+d=(a,b,c)o+t(a,b,c)d+d

R_{\mu \nu} - {1 \over 2}g_{\mu \nu}\,R + g_{\mu \nu} \Lambda
= {8 \pi G \over c^4} T_{\mu \nu}
$$

### Intersection Tests
Few important things about intersection routines:
* Ray::tMax defines the endpoint of the ray,intersection should ignore any intersections that occur after this point.
* If there are multiple intersections along the ray, the closest one should be reported.
* The rays passed into intersection routines are in world space, so shapes are responsible for transforming them to object space if needed for intersection tests. The intersection information returned should be in world space.

### Sidedness
Many rendering system,paricularly those based on scan line or z-buffer algorithms,support the concept of "one-sided"--the shape is visible if seen from the front but disappears when viewd from behind.

## Spheres
A special case of quadrics.
Describe as an implict function:

![img](https://learning.oreilly.com/library/view/physically-based-rendering/9780128007099/images/B9780128006450500038/si4_e.png)

or can also be described parametrically using a function to map 2D points to 3D points on the surface.
Like 2D spherical coordinates (θ, ϕ) as follow:

![img](https://learning.oreilly.com/library/view/physically-based-rendering/9780128007099/images/B9780128006450500038/si5_e.png)

![img](https://learning.oreilly.com/library/view/physically-based-rendering/9780128007099/images/B9780128006450500038/f03-04-9780128006450.jpg)

Commonly,we transform this function f (θ, ϕ) into a function f (u, v) over [0, 1]2 and also generalize it slightly to allow partial spheres that only sweep out θ ∈ [θmin, θmax] and ϕ ∈ [0, ϕmax]with the substitution

![img](https://learning.oreilly.com/library/view/physically-based-rendering/9780128007099/images/B9780128006450500038/si6_e.png)

## Cylinders

![img](https://learning.oreilly.com/library/view/physically-based-rendering/9780128007099/images/B9780128006450500038/f03-06-9780128006450.jpg)


Parametric form:

![img](https://learning.oreilly.com/library/view/physically-based-rendering/9780128007099/images/B9780128006450500038/si26_e.png)

### Bounding:
The method computes a conservative bounding box using the z range but withut taking into account the maximum ϕ


## Disks

![img](https://learning.oreilly.com/library/view/physically-based-rendering/9780128007099/images/B9780128006450500038/f03-08-9780128006450.jpg)


Parametric form:

![img](https://learning.oreilly.com/library/view/physically-based-rendering/9780128007099/images/B9780128006450500038/si32_e.png)

### Bounding
A bounding box centered at the height of the disk along z,with extent of radius in both x and y directions.

### Surface Area

![img](https://learning.oreilly.com/library/view/physically-based-rendering/9780128007099/images/B9780128006450500038/si35_e.png)

## Other Quadrics
Cones,paraboloids,hyperboloids,which was introduced more detail in http://www.pbr-book.org/3ed-2018/Shapes/Other_Quadrics.html

![img](https://learning.oreilly.com/library/view/physically-based-rendering/9780128007099/images/B9780128006450500038/f03-10-9780128006450.jpg)